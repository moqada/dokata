<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">src/cli.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
</head>
<body class="layout-container">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/moqada/dokata.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/index.js~Dokata.html">Dokata</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/index.js~Generator.html">Generator</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/cli.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">#!/usr/bin/env node
import chalk from &apos;chalk&apos;;
import inquirer from &apos;inquirer&apos;;
import updateNotifier from &apos;update-notifier&apos;;
import yargs from &apos;yargs&apos;;

import Dokata from &apos;./&apos;;
import pkg from &apos;../package.json&apos;;

updateNotifier({pkg}).notify();

const argv = yargs
  .usage(&apos;Usage: dokata [options] &lt;generator_path&gt;&apos;)
  .example(&apos;dokata /path/to/generator&apos;, &apos;extract template to current dir.&apos;)
  .example(&apos;dokata -o /path/to/output /path/to/generator&apos;, &apos;extract template to output dir.&apos;)
  .example(&apos;dokata generator_name&apos;, &apos;extract template to current dir (MUST: $DOKATA_TEMPLATE_DIR).&apos;)
  .example(&apos;dokata -l&apos;, &apos;Listing template names (MUST: $DOKATA_TEMPLATE_DIR).&apos;)
  .option(&apos;o&apos;, {
    alias: &apos;output-dir&apos;,
    describe: &apos;Set output directory path&apos;,
    type: &apos;string&apos;,
    &apos;default&apos;: &apos;.&apos;
  })
  .option(&apos;l&apos;, {
    alias: &apos;list&apos;,
    describe: &apos;Listing template names&apos;
  })
  .help(&apos;help&apos;)
  .version(pkg.version)
  .detectLocale(false)
  .strict()
  .wrap(null)
  .argv;


/**
 * Generate project
 *
 * @param {string} name generator name
 * @param {Object} options options
 */
function generateProject(name, options) {
  const dokata = new Dokata(process.env.DOKATA_TEMPLATE_DIR);
  const generator = dokata.createGenerator(name);
  if (generator === null) {
    throw new Error(`Does not exist generator: ${name}`);
  }
  inquirer.prompt(generator.config.questions, answers =&gt; {
    generator.updateContext(answers);
    generator.on(&apos;create:file&apos;, filepath =&gt; {
      console.log(`${chalk.gray(&apos;file&apos;)}:\t${chalk.bold(filepath)}`);
    })
    .on(&apos;create:dir&apos;, dirpath =&gt; {
      console.log(`${chalk.gray(&apos;dir&apos;)}:\t${chalk.bold(dirpath)}`);
    })
    .on(&apos;done&apos;, () =&gt; {
      console.log(chalk.green.bold(&apos;Success!&apos;));
      process.exit();
    })
    .execute(options.outputDir);
  });
}


/**
 * List generator names
 */
function listGeneratorNames() {
  if (!process.env.DOKATA_TEMPLATE_DIR) {
    console.error(chalk.red(&apos;Please set DOKATA_TEMPLATE_DIR&apos;));
    process.exit(1);
  }
  const dokata = new Dokata(process.env.DOKATA_TEMPLATE_DIR);
  dokata.getGeneratorConfigs().forEach(config =&gt; console.log(config.name));
  process.exit();
}


/**
 * execute
 *
 * @param {string[]} args command line arguments
 * @param {Object} options command line options
 */
function execute(args, options) {
  try {
    if (options.list) {
      listGeneratorNames();
    } else if (args.length &gt; 0) {
      generateProject(args[0], options);
    } else {
      throw new Error(&apos;Please set generator name&apos;);
    }
  } catch (e) {
    console.error(chalk.red(e));
    process.exit(1);
  }
}

execute(argv._, argv);
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.0)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
